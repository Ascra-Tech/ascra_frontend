{"version":3,"mappings":"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","names":["_openBlock","_createElementBlock","_hoisted_1","userResource","createResource","error","router","sessionUser","_sessionUser","session","reactive","email","password","data","computed","routes","__vitePreload","createRouter","createWebHistory","to","from","next","__async","isLoggedIn","requiresAuth","socket","initSocket","host","siteName","port","socketio_port","url","io","useTheme","isDark","ref","systemPreference","checkSystemPreference","getSavedTheme","saved","applyTheme","dark","html","setTheme","toggleTheme","setSystemTheme","systemDark","initTheme","watchSystemPreference","e","onMounted","globalComponents","Button","TextInput","Input","FormControl","ErrorMessage","Dialog","Alert","Badge","app","createApp","App","setConfig","frappeRequest","resourcesPlugin","pageMetaPlugin","key","theme"],"ignoreList":[],"sources":["../../../frontend/src/App.vue","../../../frontend/src/data/user.js","../../../frontend/src/data/session.js","../../../frontend/src/router.js","../../../frontend/src/socket.js","../../../frontend/src/composables/useTheme.js","../../../frontend/src/main.js"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200\">\n    <router-view />\n  </div>\n</template>\n","import router from \"@/router\"\nimport { createResource } from \"frappe-ui\"\n\nexport const userResource = createResource({\n\turl: \"frappe.auth.get_logged_user\",\n\tcache: \"User\",\n\tonError(error) {\n\t\tif (error && error.exc_type === \"AuthenticationError\") {\n\t\t\trouter.push({ name: \"LoginPage\" })\n\t\t}\n\t},\n})\n","import router from \"@/router\"\nimport { createResource } from \"frappe-ui\"\nimport { computed, reactive } from \"vue\"\n\nimport { userResource } from \"./user\"\n\nexport function sessionUser() {\n\tconst cookies = new URLSearchParams(document.cookie.split(\"; \").join(\"&\"))\n\tlet _sessionUser = cookies.get(\"user_id\")\n\tif (_sessionUser === \"Guest\") {\n\t\t_sessionUser = null\n\t}\n\treturn _sessionUser\n}\n\nexport const session = reactive({\n\tlogin: createResource({\n\t\turl: \"login\",\n\t\tmakeParams({ email, password }) {\n\t\t\treturn {\n\t\t\t\tusr: email,\n\t\t\t\tpwd: password,\n\t\t\t}\n\t\t},\n\t\tonSuccess(data) {\n\t\t\tuserResource.reload()\n\t\t\tsession.user = sessionUser()\n\t\t\tsession.login.reset()\n\t\t\t// Redirect to my account page for logged-in users\n\t\t\trouter.replace(\"/my-account\")\n\t\t},\n\t}),\n\tlogout: createResource({\n\t\turl: \"logout\",\n\t\tonSuccess() {\n\t\t\tuserResource.reset()\n\t\t\tsession.user = sessionUser()\n\t\t\trouter.replace({ name: \"Login\" })\n\t\t},\n\t}),\n\tuser: sessionUser(),\n\tisLoggedIn: computed(() => !!session.user),\n})\n","import { userResource } from \"@/data/user\"\nimport { createRouter, createWebHistory } from \"vue-router\"\nimport { session } from \"./data/session\"\n\nconst routes = [\n\t{\n\t\tpath: \"/\",\n\t\tname: \"Home\",\n\t\tcomponent: () => import(\"@/pages/Home.vue\"),\n\t\tmeta: { requiresAuth: false }\n\t},\n\t{\n\t\tname: \"Login\",\n\t\tpath: \"/account/login\",\n\t\tcomponent: () => import(\"@/pages/Login.vue\"),\n\t\tmeta: { requiresAuth: false }\n\t},\n\t{\n\t\tname: \"Signup\",\n\t\tpath: \"/account/signup\",\n\t\tcomponent: () => import(\"@/pages/Signup.vue\"),\n\t\tmeta: { requiresAuth: false }\n\t},\n\t{\n\t\tname: \"MyAccount\",\n\t\tpath: \"/my-account\",\n\t\tcomponent: () => import(\"@/pages/MyAccount.vue\"),\n\t\tmeta: { requiresAuth: true }\n\t},\n\t{\n\t\tname: \"TestSwitch\",\n\t\tpath: \"/test-switch\",\n\t\tcomponent: () => import(\"@/pages/TestSwitch.vue\"),\n\t\tmeta: { requiresAuth: false }\n\t},\n\t{\n\t\tname: \"EmployeeDashboard\",\n\t\tpath: \"/employee-dashboard\",\n\t\tcomponent: () => import(\"@/pages/EmployeeDashboard.vue\"),\n\t\tmeta: { requiresAuth: true, requiresEmployeeRole: true }\n\t},\n\t{\n\t\tname: \"ERPNext\",\n\t\tpath: \"/erpnext\",\n\t\tcomponent: () => import(\"@/pages/ERPNext.vue\"),\n\t\tmeta: { requiresAuth: false }\n\t},\n]\n\nconst router = createRouter({\n\thistory: createWebHistory(\"/\"),\n\troutes,\n})\n\nrouter.beforeEach(async (to, from, next) => {\n\tlet isLoggedIn = session.isLoggedIn\n\ttry {\n\t\tawait userResource.promise\n\t} catch (error) {\n\t\tisLoggedIn = false\n\t}\n\n\t// Check if route requires authentication\n\tconst requiresAuth = to.meta.requiresAuth\n\n\tif (to.name === \"Login\" && isLoggedIn) {\n\t\t// Redirect logged-in users away from login page to my account\n\t\tnext({ name: \"MyAccount\" })\n\t} else if (requiresAuth && !isLoggedIn) {\n\t\t// Redirect unauthenticated users to login for protected routes\n\t\tnext({ name: \"Login\" })\n\t} else {\n\t\t// Allow navigation\n\t\tnext()\n\t}\n})\n\nexport default router\n","import { io } from \"socket.io-client\"\nimport { socketio_port } from \"../../../../sites/common_site_config.json\"\n\nlet socket = null\nexport function initSocket() {\n\tconst host = window.location.hostname\n\tconst siteName = window.site_name\n\tconst port = window.location.port ? `:${socketio_port}` : \"\"\n\tconst protocol = port ? \"http\" : \"https\"\n\tconst url = `${protocol}://${host}${port}/${siteName}`\n\n\tsocket = io(url, {\n\t\twithCredentials: true,\n\t\treconnectionAttempts: 5,\n\t})\n\treturn socket\n}\n\nexport function useSocket() {\n\treturn socket\n}\n","import { ref, onMounted, watch } from 'vue'\n\nexport function useTheme() {\n  const isDark = ref(false)\n  const systemPreference = ref(false)\n\n  // Check system preference\n  const checkSystemPreference = () => {\n    if (typeof window !== 'undefined') {\n      systemPreference.value = window.matchMedia('(prefers-color-scheme: dark)').matches\n      return systemPreference.value\n    }\n    return false\n  }\n\n  // Get saved theme from localStorage\n  const getSavedTheme = () => {\n    if (typeof window !== 'undefined') {\n      const saved = localStorage.getItem('theme')\n      if (saved) {\n        return saved === 'dark'\n      }\n    }\n    return null\n  }\n\n  // Apply theme to document\n  const applyTheme = (dark) => {\n    if (typeof document !== 'undefined') {\n      const html = document.documentElement\n      if (dark) {\n        html.classList.add('dark')\n      } else {\n        html.classList.remove('dark')\n      }\n    }\n  }\n\n  // Set theme\n  const setTheme = (dark) => {\n    isDark.value = dark\n    applyTheme(dark)\n    \n    // Save to localStorage\n    if (typeof window !== 'undefined') {\n      localStorage.setItem('theme', dark ? 'dark' : 'light')\n    }\n  }\n\n  // Toggle theme\n  const toggleTheme = () => {\n    setTheme(!isDark.value)\n  }\n\n  // Set system theme\n  const setSystemTheme = () => {\n    const systemDark = checkSystemPreference()\n    setTheme(systemDark)\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('theme') // Remove saved preference to use system\n    }\n  }\n\n  // Initialize theme\n  const initTheme = () => {\n    const saved = getSavedTheme()\n    if (saved !== null) {\n      setTheme(saved)\n    } else {\n      // Use system preference as default\n      setSystemTheme()\n    }\n  }\n\n  // Watch for system preference changes\n  const watchSystemPreference = () => {\n    if (typeof window !== 'undefined') {\n      const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)')\n      mediaQuery.addEventListener('change', (e) => {\n        systemPreference.value = e.matches\n        // Only update if user hasn't set a manual preference\n        if (getSavedTheme() === null) {\n          setTheme(e.matches)\n        }\n      })\n    }\n  }\n\n  onMounted(() => {\n    watchSystemPreference()\n  })\n\n  return {\n    isDark,\n    systemPreference,\n    toggleTheme,\n    setTheme,\n    setSystemTheme,\n    initTheme\n  }\n}\n\n// Initialize theme immediately to prevent flash\nif (typeof window !== 'undefined') {\n  const saved = localStorage.getItem('theme')\n  let isDark = false\n  \n  if (saved) {\n    isDark = saved === 'dark'\n  } else {\n    isDark = window.matchMedia('(prefers-color-scheme: dark)').matches\n  }\n  \n  // Apply theme immediately\n  if (isDark) {\n    document.documentElement.classList.add('dark')\n  } else {\n    document.documentElement.classList.remove('dark')\n  }\n}\n","import { createApp } from \"vue\"\nimport { FrappeUI } from \"frappe-ui\"\n\nimport App from \"./App.vue\"\nimport router from \"./router\"\nimport { initSocket } from \"./socket\"\nimport \"./index.css\"\nimport { useTheme } from \"./composables/useTheme\"\n\nimport {\n\tAlert,\n\tBadge,\n\tButton,\n\tDialog,\n\tErrorMessage,\n\tFormControl,\n\tInput,\n\tTextInput,\n\tfrappeRequest,\n\tpageMetaPlugin,\n\tresourcesPlugin,\n\tsetConfig,\n} from \"frappe-ui\"\n\nimport \"./index.css\"\n\nconst globalComponents = {\n\tButton,\n\tTextInput,\n\tInput,\n\tFormControl,\n\tErrorMessage,\n\tDialog,\n\tAlert,\n\tBadge,\n}\n\nconst app = createApp(App)\n\nsetConfig(\"resourceFetcher\", frappeRequest)\n\napp.use(router)\napp.use(resourcesPlugin)\napp.use(pageMetaPlugin)\n\nconst socket = initSocket()\napp.config.globalProperties.$socket = socket\n\nfor (const key in globalComponents) {\n\tapp.component(key, globalComponents[key])\n}\n\n// Initialize theme before mounting app\nconst theme = useTheme()\ntheme.initTheme()\n\napp.mount(\"#app\")\n"],"file":"assets/index-gwP749wE.js"}