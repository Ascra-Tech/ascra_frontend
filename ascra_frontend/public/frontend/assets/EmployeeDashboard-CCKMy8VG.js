var v=(M,w,u)=>new Promise((i,y)=>{var _=d=>{try{m(u.next(d))}catch(p){y(p)}},h=d=>{try{m(u.throw(d))}catch(p){y(p)}},m=d=>d.done?i(d.value):Promise.resolve(d.value).then(_,h);m((u=u.apply(M,w)).next())});import{K as I,o,c as l,a as g,w as e,B as r,A as k,y as b,O as D,P as j,C as P,E as L,F as $,z as O,G as E,x as B,J as x,H as c,r as W,Q as S}from"./frappe-ui-B3DSNYfP.js";import{_ as G}from"./Navigation-CTXRm9aE.js";import"./index-BooeZ-5s.js";const J={class:"min-h-screen bg-gray-50"},K={id:"employee-dashboard",class:"pt-20 pb-12"},Q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},X={class:"mb-8"},Y={key:0,class:"text-gray-600 mt-2"},Z={key:0,class:"flex justify-center items-center py-12"},ee={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6 mb-8"},te={class:"flex items-center"},se={class:"text-red-800"},ae={key:2,class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8"},oe={class:"flex items-center space-x-4"},le={class:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white text-xl font-bold"},re={class:"text-xl font-bold text-gray-900"},ne={class:"text-gray-600"},ie={class:"text-sm text-gray-500"},de={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},ce={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},ue={class:"bg-white rounded-xl shadow-sm border border-gray-200"},pe={class:"p-6"},ve={key:0,class:"text-center py-8 text-gray-500"},me={key:1,class:"space-y-3"},ge={class:"font-medium text-gray-900"},ye={class:"text-sm text-gray-600"},fe={class:"bg-white rounded-xl shadow-sm border border-gray-200"},be={class:"p-6"},xe={key:0,class:"text-center py-8 text-gray-500"},_e={key:1,class:"space-y-3"},he={class:"font-medium text-gray-900"},we={class:"text-sm text-gray-600"},ke={key:3,class:"mt-8 bg-white rounded-xl shadow-sm border border-gray-200"},Le={class:"p-6"},Ce={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ae={class:"font-medium text-gray-900"},De={class:"text-2xl font-bold text-blue-600"},je={class:"text-sm text-gray-600"},Ee={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Me={class:"bg-white rounded-xl p-6 w-full max-w-md mx-4"},Ve={class:"flex justify-between items-center mb-4"},Be={class:"grid grid-cols-2 gap-4"},Se={class:"flex space-x-3"},Re={__name:"EmployeeDashboard",setup(M){const w=c(!0),u=c(""),i=c(null),y=c([]),_=c([]),h=c([]),m=c(!1),d=c(!1),p=c(!1),n=c({leaveType:"",fromDate:"",toDate:"",description:""}),T=s=>s?s.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().substring(0,2):"E",C=s=>s?new Date(s).toLocaleDateString():"N/A",z=s=>s?new Date(s).toLocaleTimeString():"N/A",F=s=>({Present:"bg-green-100 text-green-800",Absent:"bg-red-100 text-red-800","On Leave":"bg-yellow-100 text-yellow-800","Half Day":"bg-blue-100 text-blue-800","Work From Home":"bg-purple-100 text-purple-800"})[s]||"bg-gray-100 text-gray-800",N=s=>({Open:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800",Cancelled:"bg-gray-100 text-gray-800"})[s]||"bg-gray-100 text-gray-800",R=()=>v(this,null,function*(){try{const s=yield x("ascra_frontend.api.get_employee_info");s.success&&(i.value=s.employee)}catch(s){console.error("Error loading employee info:",s),u.value=s.message||"Failed to load employee information"}}),A=()=>v(this,null,function*(){try{const s=yield x("ascra_frontend.api.get_attendance_records");s.success&&(y.value=s.attendance_records)}catch(s){console.error("Error loading attendance records:",s)}}),V=()=>v(this,null,function*(){try{const s=yield x("ascra_frontend.api.get_leave_applications");s.success&&(_.value=s.leave_applications)}catch(s){console.error("Error loading leave applications:",s)}}),H=()=>v(this,null,function*(){try{const s=yield x("ascra_frontend.api.get_leave_balance");s.success&&(h.value=s.leave_balance)}catch(s){console.error("Error loading leave balance:",s)}}),U=()=>v(this,null,function*(){m.value=!0;try{(yield x("ascra_frontend.api.mark_attendance",{status:"Present"})).success&&(alert("Attendance marked successfully!"),yield A())}catch(s){console.error("Error marking attendance:",s),alert(s.message||"Failed to mark attendance")}finally{m.value=!1}}),q=()=>v(this,null,function*(){d.value=!0;try{(yield x("ascra_frontend.api.apply_leave",{leave_type:n.value.leaveType,from_date:n.value.fromDate,to_date:n.value.toDate,description:n.value.description})).success&&(alert("Leave application submitted successfully!"),p.value=!1,n.value={leaveType:"",fromDate:"",toDate:"",description:""},yield V())}catch(s){console.error("Error submitting leave application:",s),alert(s.message||"Failed to submit leave application")}finally{d.value=!1}});return I(()=>v(this,null,function*(){try{yield Promise.all([R(),A(),V(),H()])}catch(s){console.error("Error initializing employee dashboard:",s),u.value="Failed to load dashboard data"}finally{w.value=!1}})),(s,t)=>{const f=W("Button");return o(),l("div",J,[g(G),e("div",K,[e("div",Q,[e("div",X,[t[7]||(t[7]=e("h1",{class:"text-3xl font-bold text-gray-900"}," Employee Dashboard ",-1)),i.value?(o(),l("p",Y," Welcome, "+r(i.value.employee_name)+"! Manage your attendance, leaves, and view salary information. ",1)):k("",!0)]),w.value?(o(),l("div",Z,[...t[8]||(t[8]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)])])):u.value?(o(),l("div",ee,[e("div",te,[t[9]||(t[9]=e("svg",{class:"w-6 h-6 text-red-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",se,r(u.value),1)])])):i.value?(o(),l("div",ae,[e("div",oe,[e("div",le,r(T(i.value.employee_name)),1),e("div",null,[e("h2",re,r(i.value.employee_name),1),e("p",ne,r(i.value.designation)+" - "+r(i.value.department),1),e("p",ie,"Employee ID: "+r(i.value.employee_number),1)])])])):k("",!0),e("div",de,[g(f,{theme:"blue",variant:"solid",class:"h-20 flex flex-col items-center justify-center space-y-2",onClick:U,loading:m.value},{default:b(()=>[...t[10]||(t[10]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("span",null,"Mark Attendance",-1)])]),_:1},8,["loading"]),g(f,{theme:"green",variant:"outline",class:"h-20 flex flex-col items-center justify-center space-y-2",onClick:t[0]||(t[0]=a=>p.value=!0)},{default:b(()=>[...t[11]||(t[11]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),e("span",null,"Apply Leave",-1)])]),_:1}),g(f,{theme:"purple",variant:"outline",class:"h-20 flex flex-col items-center justify-center space-y-2",onClick:A},{default:b(()=>[...t[12]||(t[12]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),e("span",null,"View Attendance",-1)])]),_:1}),g(f,{theme:"orange",variant:"outline",class:"h-20 flex flex-col items-center justify-center space-y-2",onClick:s.loadSalarySlips},{default:b(()=>[...t[13]||(t[13]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})],-1),e("span",null,"Salary Slips",-1)])]),_:1},8,["onClick"])]),e("div",ce,[e("div",ue,[t[14]||(t[14]=e("div",{class:"p-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Recent Attendance")],-1)),e("div",pe,[y.value.length===0?(o(),l("div",ve," No attendance records found ")):(o(),l("div",me,[(o(!0),l(D,null,j(y.value.slice(0,5),a=>(o(),l("div",{key:a.name,class:"flex justify-between items-center p-3 bg-gray-50 rounded-lg"},[e("div",null,[e("p",ge,r(C(a.attendance_date)),1),e("p",ye,r(a.in_time?z(a.in_time):"N/A"),1)]),e("span",{class:S([F(a.status),"px-2 py-1 text-xs font-medium rounded-full"])},r(a.status),3)]))),128))]))])]),e("div",fe,[t[15]||(t[15]=e("div",{class:"p-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Leave Applications")],-1)),e("div",be,[_.value.length===0?(o(),l("div",xe," No leave applications found ")):(o(),l("div",_e,[(o(!0),l(D,null,j(_.value.slice(0,5),a=>(o(),l("div",{key:a.name,class:"flex justify-between items-center p-3 bg-gray-50 rounded-lg"},[e("div",null,[e("p",he,r(a.leave_type),1),e("p",we,r(C(a.from_date))+" - "+r(C(a.to_date)),1)]),e("span",{class:S([N(a.status),"px-2 py-1 text-xs font-medium rounded-full"])},r(a.status),3)]))),128))]))])])]),h.value.length>0?(o(),l("div",ke,[t[16]||(t[16]=e("div",{class:"p-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Leave Balance")],-1)),e("div",Le,[e("div",Ce,[(o(!0),l(D,null,j(h.value,a=>(o(),l("div",{key:a.leave_type,class:"bg-blue-50 rounded-lg p-4"},[e("h4",Ae,r(a.leave_type),1),e("p",De,r(a.total_leaves_allocated-a.leaves_taken),1),e("p",je,"Available out of "+r(a.total_leaves_allocated),1)]))),128))])])])):k("",!0)])]),p.value?(o(),l("div",Ee,[e("div",Me,[e("div",Ve,[t[18]||(t[18]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Apply for Leave",-1)),e("button",{onClick:t[1]||(t[1]=a=>p.value=!1),class:"text-gray-400 hover:text-gray-600"},[...t[17]||(t[17]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:P(q,["prevent"]),class:"space-y-4"},[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Leave Type",-1)),L(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>n.value.leaveType=a),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[19]||(t[19]=[O('<option value="">Select Leave Type</option><option value="Annual Leave">Annual Leave</option><option value="Sick Leave">Sick Leave</option><option value="Casual Leave">Casual Leave</option><option value="Emergency Leave">Emergency Leave</option>',5)])],512),[[$,n.value.leaveType]])]),e("div",Be,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"From Date",-1)),L(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>n.value.fromDate=a),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[E,n.value.fromDate]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"To Date",-1)),L(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>n.value.toDate=a),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[E,n.value.toDate]])])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Reason",-1)),L(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=a=>n.value.description=a),rows:"3",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Reason for leave..."},null,512),[[E,n.value.description]])]),e("div",Se,[g(f,{type:"submit",theme:"blue",variant:"solid",class:"flex-1",loading:d.value},{default:b(()=>[...t[24]||(t[24]=[B(" Submit Application ",-1)])]),_:1},8,["loading"]),g(f,{type:"button",theme:"gray",variant:"outline",onClick:t[6]||(t[6]=a=>p.value=!1)},{default:b(()=>[...t[25]||(t[25]=[B(" Cancel ",-1)])]),_:1})])],32)])])):k("",!0)])}}};export{Re as default};
//# sourceMappingURL=EmployeeDashboard-CCKMy8VG.js.map
